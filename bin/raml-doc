#!/usr/bin/env ruby

require "optparse"
require "bundler/setup"
require "raml_doc"

options = {
  :template => "default",
  :format   => "html"
}

option_parser = OptionParser.new do |opts|
  opts.banner = "Usage: ramldoc [options]"

  opts.on("-v", "--version", "Prints the version") do |value|
    if value
      puts "RamlDoc #{RamlDoc::VERSION}"
      exit 0
    end
  end

  opts.on("-s", "--source-file FILE", "The source RAML file") do |value|
    options[:source_file] = value
  end

  opts.on("-t", "--template [default]", "The output template to use") do |value|
    options[:template] = value
  end

  opts.on("-f", "--format [html]", "The output file format") do |value|
    options[:template] = value
  end
end

option_parser.parse!

source_file = options[:source_file]
template = options[:template]
format = options[:format]

if source_file.to_s.strip.empty?
  puts "You must specifiy a source file! See: --source-file -s"
  exit 1
end

if template.to_s.strip.empty?
  puts "You must specify a template! See: --template -t"
  exit 1
end

if format.to_s.strip.empty?
  puts "You must specify a format! See: --format -f"
  exit 1
end

puts RamlDoc.generate(source_file, template, format)
